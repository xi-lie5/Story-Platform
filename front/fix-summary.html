<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤´åƒæ˜¾ç¤ºé—®é¢˜ä¿®å¤æ€»ç»“</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="assets/js/auth.js"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6 text-green-600">ğŸ‰ å¤´åƒæ˜¾ç¤ºé—®é¢˜ä¿®å¤å®Œæˆï¼</h1>
        
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">âœ… å·²å®Œæˆçš„ä¿®å¤</h2>
            <div class="space-y-3">
                <div class="flex items-start">
                    <span class="text-green-500 mr-2">âœ“</span>
                    <div>
                        <strong>DOMåŠ è½½æ—¶æœºä¿®å¤ï¼š</strong>å°†AuthUI.init()è°ƒç”¨åŒ…è£…åœ¨DOMContentLoadedäº‹ä»¶ä¸­ï¼Œç¡®ä¿DOMå…ƒç´ åŠ è½½å®Œæˆåå†åˆå§‹åŒ–
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-green-500 mr-2">âœ“</span>
                    <div>
                        <strong>JavaScriptä»£ç é‡æ„ï¼š</strong>å°†æ‰€æœ‰JavaScriptä»£ç ç»Ÿä¸€åŒ…è£…åœ¨DOMContentLoadedäº‹ä»¶å¤„ç†å‡½æ•°ä¸­
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-green-500 mr-2">âœ“</span>
                    <div>
                        <strong>åç«¯APIéªŒè¯ï¼š</strong>ç¡®è®¤ç™»å½•APIæ­£ç¡®è¿”å›å¤´åƒä¿¡æ¯ï¼ˆ/avatar/default.pngï¼‰
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-green-500 mr-2">âœ“</span>
                    <div>
                        <strong>é™æ€æ–‡ä»¶æœåŠ¡éªŒè¯ï¼š</strong>ç¡®è®¤åç«¯æ­£ç¡®æä¾›å¤´åƒæ–‡ä»¶è®¿é—®ï¼ˆHTTP 200çŠ¶æ€ï¼‰
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-green-500 mr-2">âœ“</span>
                    <div>
                        <strong>AuthUIç»„ä»¶éªŒè¯ï¼š</strong>ç¡®è®¤AuthUIç»„ä»¶æ­£ç¡®è§£æå’Œæ¸²æŸ“å¤´åƒURL
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">ğŸ”§ æŠ€æœ¯ç»†èŠ‚</h2>
            <div class="bg-gray-50 rounded p-4 text-sm font-mono">
                <div class="mb-2"><strong>ä¿®å¤å‰é—®é¢˜ï¼š</strong></div>
                <div class="text-red-600 mb-4">AuthUI.init()åœ¨DOMå…ƒç´ åŠ è½½å‰æ‰§è¡Œï¼Œå¯¼è‡´æ— æ³•æ‰¾åˆ°auth-area-desktopç­‰å®¹å™¨</div>
                
                <div class="mb-2"><strong>ä¿®å¤æ–¹æ¡ˆï¼š</strong></div>
                <div class="text-green-600">
                    document.addEventListener('DOMContentLoaded', function() {<br>
                    &nbsp;&nbsp;// æ‰€æœ‰JavaScriptä»£ç <br>
                    &nbsp;&nbsp;AuthUI.init();<br>
                    });
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">ğŸ§ª æµ‹è¯•éªŒè¯</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="window.open('full-test.html', '_blank')" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                    å®Œæ•´ç™»å½•æµ‹è¯•
                </button>
                <button onclick="window.open('avatar-test.html', '_blank')" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                    å¤´åƒæ˜¾ç¤ºæµ‹è¯•
                </button>
                <button onclick="window.open('auto-login-test.html', '_blank')" class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600">
                    è‡ªåŠ¨ç™»å½•æµ‹è¯•
                </button>
                <button onclick="window.open('test-auth.html', '_blank')" class="px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-600">
                    AuthUIè°ƒè¯•é¡µé¢
                </button>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">ğŸ“‹ å½“å‰ç™»å½•çŠ¶æ€</h2>
            <div id="auth-status" class="text-sm"></div>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-semibold mb-4">ğŸš€ ç«‹å³ä½“éªŒ</h2>
            <div class="space-x-4">
                <button onclick="goToLogin()" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90">
                    å»ç™»å½•é¡µé¢
                </button>
                <button onclick="goToIndex()" class="px-6 py-3 bg-secondary text-white rounded-lg hover:bg-secondary/90">
                    å»é¦–é¡µæŸ¥çœ‹å¤´åƒ
                </button>
            </div>
        </div>
    </div>

    <script>
        function updateAuthStatus() {
            const authState = window.AuthUI.getAuthState();
            const statusDiv = document.getElementById('auth-status');
            
            if (authState) {
                const avatarUrl = window.AuthUI.resolveAvatarUrl(authState.userInfo.avatar, authState.userInfo.username);
                statusDiv.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <img src="${avatarUrl}" alt="${authState.userInfo.username}" class="w-16 h-16 rounded-full border-2 border-green-500">
                        <div>
                            <div class="font-semibold text-green-600">âœ“ å·²ç™»å½•</div>
                            <div>ç”¨æˆ·å: ${authState.userInfo.username}</div>
                            <div>é‚®ç®±: ${authState.userInfo.email}</div>
                            <div>å¤´åƒ: ${authState.userInfo.avatar}</div>
                        </div>
                    </div>
                `;
            } else {
                statusDiv.innerHTML = '<div class="text-red-600 font-medium">âœ— æœªç™»å½•</div>';
            }
        }

        function goToLogin() {
            window.location.href = 'login.html';
        }

        function goToIndex() {
            window.location.href = 'index.html';
        }

        // é¡µé¢åŠ è½½æ—¶æ›´æ–°çŠ¶æ€
        document.addEventListener('DOMContentLoaded', function() {
            updateAuthStatus();
            
            // æ¯3ç§’æ›´æ–°ä¸€æ¬¡çŠ¶æ€
            setInterval(updateAuthStatus, 3000);
        });
    </script>
</body>
</html>